/**
    @name: aping-plugin-dailymotion 
    @version: 0.7.6 (11-01-2016) 
    @author: Jonathan Hornung <jonathan.hornung@gmail.com> 
    @url: https://github.com/JohnnyTheTank/apiNG-plugin-dailymotion#readme 
    @license: MIT
*/
"use strict";var jjtApingDailymotion=angular.module("jtt_aping_dailymotion",["jtt_dailymotion"]).directive("apingDailymotion",["apingDailymotionHelper","apingUtilityHelper","dailymotionFactory",function(a,b,c){return{require:"?aping",restrict:"A",replace:"false",link:function(d,e,f,g){var h=g.getAppSettings(),i=b.parseJsonFromAttributes(f.apingDailymotion,a.getThisPlattformString(),h);i.forEach(function(b){var d={model:h.model};"undefined"!=typeof h.getNativeData?d.getNativeData=h.getNativeData:d.getNativeData=!1;var e={};return"undefined"!=typeof b.items?e.limit=b.items:e.limit=h.items,0==e.limit?!1:((e.limit<0||isNaN(e.limit))&&(e.limit=void 0),e.limit>100&&(e.limit=100),"undefined"!=typeof b.search&&(e.search=b.search),"undefined"!=typeof b.tags&&(e.tags=b.tags),void(b.userId?(e.id=b.userId,e.sort="recent","undefined"!=typeof b.channelId&&(e.channel=b.channelId),c.getVideosFromUserById(e).then(function(b){b&&g.concatToResults(a.getObjectByJsonData(b,d))})):b.channelId?(e.id=b.channelId,e.sort="recent",c.getVideosFromChannelById(e).then(function(b){b&&g.concatToResults(a.getObjectByJsonData(b,d))})):b.playlistId?(e.id=b.playlistId,e.sort="recent",c.getVideosFromPlaylistById(e).then(function(b){b&&g.concatToResults(a.getObjectByJsonData(b,d))})):("undefined"!=typeof b.genre&&(e.genre=b.genre),"undefined"!=typeof b.country&&(e.country=b.country),"undefined"!=typeof b.language&&(e.detected_language=b.language),c.getVideosByParams(e).then(function(b){b&&g.concatToResults(a.getObjectByJsonData(b,d))}))))})}}}]);jjtApingDailymotion.service("apingDailymotionHelper",["apingModels","apingTimeHelper","apingUtilityHelper",function(a,b,c){this.getThisPlattformString=function(){return"dailymotion"},this.getThisPlatformLink=function(){return"https://dailymotion.com/"},this.getObjectByJsonData=function(a,b){var c=[];if(a){var d=this;a&&angular.forEach(a.data.list,function(a,e){var f;f=b.getNativeData===!0||"true"===b.getNativeData?a:d.getItemByJsonData(a,b.model),f&&c.push(f)})}return c},this.getItemByJsonData=function(a,b){var c={};if(a&&b)switch(b){case"social":c=this.getSocialItemByJsonData(a);break;case"video":c=this.getVideoItemByJsonData(a);break;default:return!1}return c},this.getSocialItemByJsonData=function(b){var d=a.getNew("social",this.getThisPlattformString());return $.extend(!0,d,{blog_name:b["owner.screenname"]||void 0,blog_id:b["owner.id"]||void 0,blog_link:b["owner.url"]||void 0,type:b.item_type||b.media_type||void 0,timestamp:1e3*b.created_time,source:b.embed_html||void 0,post_url:b.url,intern_id:b.id,text:c.getTextFromHtml(b.description),caption:b.title,img_url:b.thumbnail_url,likes:b.bookmarks_total,comments:b.comments_total}),d.date_time=new Date(d.timestamp),d},this.getVideoItemByJsonData=function(b){var d=a.getNew("video",this.getThisPlattformString());return $.extend(!0,d,{blog_name:b["owner.screenname"]||void 0,blog_id:b["owner.id"]||void 0,blog_link:b["owner.url"]||void 0,type:b.item_type||b.media_type||void 0,timestamp:1e3*b.created_time,markup:b.embed_html||void 0,post_url:b.url,intern_id:b.id,text:c.getTextFromHtml(b.description),caption:b.title,img_url:b.thumbnail_url,likes:b.bookmarks_total,comments:b.comments_total,duration:b.duration}),d.date_time=new Date(d.timestamp),d}}]),angular.module("jtt_dailymotion",[]).factory("dailymotionFactory",["$http","dailymotionSearchDataService",function(a,b){var c={};return c.getVideosFromUserById=function(c){if(!c.id)return!1;var d=b.getNew("videosFromUserById",c);return a({method:"GET",url:d.url,params:d.object})},c.getVideosFromChannelById=function(c){if(!c.id)return!1;var d=b.getNew("videosFromChannelById",c);return a({method:"GET",url:d.url,params:d.object})},c.getVideosFromPlaylistById=function(c){if(!c.id)return!1;var d=b.getNew("videosFromPlaylistById",c);return a({method:"GET",url:d.url,params:d.object})},c.getVideosByParams=function(c){var d=b.getNew("videosByParams",c);return a({method:"GET",url:d.url,params:d.object})},c}]).service("dailymotionSearchDataService",function(){this.getApiBaseUrl=function(a){return"https://api.dailymotion.com/"},this.fillDataInObjectByList=function(a,b,c){return angular.forEach(c,function(c,d){"undefined"!=typeof b[c]&&(a.object[c]=b[c])}),a},this.getNew=function(a,b){var c={object:{},url:""};switch(a){case"videosFromUserById":c.object.fields="bookmarks_total,comments_total,created_time,description,duration,embed_html,id,item_type,media_type,owner.id,owner.screenname,owner.url,thumbnail_url,title,updated_time,url,",c=this.fillDataInObjectByList(c,b,["fields","channel","created_after","created_before","genre","nogenre","page","limit","search","tags"]),c.url=this.getApiBaseUrl()+"user/"+b.id+"/videos";break;case"videosFromChannelById":c.object.fields="bookmarks_total,comments_total,created_time,description,duration,embed_html,id,item_type,media_type,owner.id,owner.screenname,owner.url,thumbnail_url,title,updated_time,url,",c=this.fillDataInObjectByList(c,b,["fields","channel","created_after","created_before","search","sort","tags","page","limit"]),c.url=this.getApiBaseUrl()+"channel/"+b.id+"/videos";break;case"videosFromPlaylistById":c.object.fields="bookmarks_total,comments_total,created_time,description,duration,embed_html,id,item_type,media_type,owner.id,owner.screenname,owner.url,thumbnail_url,title,updated_time,url,",c=this.fillDataInObjectByList(c,b,["fields","search","sort","tags","page","limit"]),c.url=this.getApiBaseUrl()+"playlist/"+b.id+"/videos";break;case"videosByParams":c.object.fields="bookmarks_total,comments_total,created_time,description,duration,embed_html,id,item_type,media_type,owner.id,owner.screenname,owner.url,thumbnail_url,title,updated_time,url,",c=this.fillDataInObjectByList(c,b,["fields","channel","country","created_after","created_before","detected_language","exclude_ids","featured","genre","has_game","hd","ids","in_history","languages","list","live","live_offair","live_onair","live_upcoming","longer_than","no_live","no_premium","nogenre","owners","partner","poster","premium","private","search","shorter_than","sort","svod","tags","tvod","ugc","verified","page","limit"]),c.url=this.getApiBaseUrl()+"videos"}return c}});